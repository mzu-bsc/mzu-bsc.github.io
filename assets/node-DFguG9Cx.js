import{u as e,r as t,d as s,k as a,v as n,j as d,a as i,B as l,s as r,g as c,N as p,c as x,f as o,t as m,q as u,i as h,l as f,y}from"./index-Dyp8DAuJ.js";import{M as w,I as g}from"./modal-CusU8sru.js";import{S as N,g as v}from"./sameNodeBox-DP3EMg7Y.js";import{s as j,w as C,a as b}from"./writeContract-CKF5oCok.js";import{b as I,C as D,a as S}from"./carousel-Ckqyngco.js";import{g as B}from"./getBlock-nNsc7IxL.js";const M=({isOpen:x,onClose:o,onUpdate:m})=>{const{t:u}=e(),[h,f]=t.useState(!1),[y,v]=t.useState(""),{showToast:I}=s(),{address:D}=a(),{currentNodeCard:S,deleteNodeCard:B}=n();return d.jsxs(w,{isOpen:x,onClose:o,title:u("node.text1"),className:"md:w-[505px] md:h-[580px]",children:[d.jsx("div",{className:"m-auto md:w-[160px]",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"h-[210px] md:h-[247px]",children:null!=S&&d.jsx(N,{typeId:S.typeId,className:i("md:w-[180px] md:h-[247px] w-[150px] h-[210px]")})}),d.jsxs("div",{className:"mt-[5px] text-[#3D3D3D] text-[20px]",children:["#",null!=S&&S.cardId]}),d.jsx("div",{className:"font-bold text-[#3D3D3D] text-[24px]",children:"MZU NFT"})]})}),d.jsx("div",{className:"grid grid-cols-1 my-6 text-[#CECFCD] text-[14px]",children:d.jsx(g,{className:"",value:y,placeholder:u("node.text2"),onChange:e=>v(e),inputClassName:"md:h-[56px] h-[45px] w-full"})}),d.jsxs("div",{className:"flex justify-center items-center space-x-[20px] md:space-x-[60px]",children:[d.jsx(l,{onClick:async()=>{if(D&&null!=S)try{if(f(!0),!r(y))return I(u("tips.errorAddress"),"error");const{request:e}=await j(c,{...p,functionName:"transferFrom",args:[D,y,BigInt(S.cardId)]}),t=await C(c,e);await b(c,{hash:t}),B(S.cardId),o(),I(u("tips.transferSuccessful"),"success"),m()}catch(e){}finally{f(!1)}},loading:h,variant:"red",className:"w-[120px] md:w-[180px] h-[40px] md:h-[3.1vw]",children:u("transfer")}),d.jsx(l,{onClick:o,variant:"redBorder",className:"w-[120px] md:w-[180px] h-[40px] md:h-[3.1vw]",children:u("cancel")})]})]})},F=s=>{const a=x.c(36),{isOpen:r,onClose:c}=s,{t:p}=e(),[o,m]=t.useState(),{currentNodeCard:u,nodes:h,setSelectedNodeCard:f}=n();let y,g,v;a[0]!==u||a[1]!==r?(y=()=>{r&&m(u)},a[0]=u,a[1]=r,a[2]=y):y=a[2],a[3]!==r?(g=[r],a[3]=r,a[4]=g):g=a[4],t.useEffect(y,g),a[5]!==o||a[6]!==c||a[7]!==f?(v=()=>{null!=o&&(f(o),c())},a[5]=o,a[6]=c,a[7]=f,a[8]=v):v=a[8];const j=v;let C,b,I,D,S,B,M,F,k;return a[9]!==p?(C=p("node.text3"),a[9]=p,a[10]=C):C=a[10],a[11]!==o||a[12]!==u||a[13]!==h?(b=null!=u&&null!=h&&h.length>0&&h.map(((e,t)=>d.jsxs("div",{onClick:()=>m(e),className:i("bg-white p-2 rounded-[8px] h-[184px]",o==e&&"border border-[#E5331C]"),children:[d.jsx(N,{typeId:e.typeId,className:i("w-[100px] h-min contrast-50",o==e&&"filter-none")}),d.jsx("div",{className:i("text-[#3D3D3D] flex justify-between px-[5px] mt-[5px] pl-[10px]",o==e&&"text-[#E5331C]"),children:d.jsxs("span",{className:"text-[16px]",children:["#",e.cardId]})})]},t))),a[11]=o,a[12]=u,a[13]=h,a[14]=b):b=a[14],a[15]!==b?(I=d.jsx("div",{className:"bg-[#F6F6F6] px-[15px] md:px-6 py-4 rounded-[12px] w-full h-[300px] md:h-[466px] overflow-auto",children:d.jsx("div",{className:"gap-2 grid grid-cols-2 md:grid-cols-4",children:b})}),a[15]=b,a[16]=I):I=a[16],a[17]!==p?(D=p("submit"),a[17]=p,a[18]=D):D=a[18],a[19]!==j||a[20]!==D?(S=d.jsx(l,{onClick:j,variant:"red",className:"w-full h-[full md:!text-[20px]",children:D}),a[19]=j,a[20]=D,a[21]=S):S=a[21],a[22]!==p?(B=p("cancel"),a[22]=p,a[23]=B):B=a[23],a[24]!==c||a[25]!==B?(M=d.jsx(l,{onClick:c,variant:"redBorder",className:"w-full h-full md:!text-[20px]",children:B}),a[24]=c,a[25]=B,a[26]=M):M=a[26],a[27]!==M||a[28]!==S?(F=d.jsxs("div",{className:"gap-[40px] grid grid-cols-2 mt-[20px] md:mt-[36px]",children:[S,M]}),a[27]=M,a[28]=S,a[29]=F):F=a[29],a[30]!==r||a[31]!==c||a[32]!==F||a[33]!==C||a[34]!==I?(k=d.jsxs(w,{isOpen:r,onClose:c,title:C,className:"md:w-[620px] md:h-[712px]",children:[I,F]}),a[30]=r,a[31]=c,a[32]=F,a[33]=C,a[34]=I,a[35]=k):k=a[35],k},k={address:"0x6C4BB7c216B147ef37b9a49f9371E2b49a9f8cd6",abi:[{name:"Deposit",type:"event",inputs:[{type:"uint256",name:"nodeCardId",indexed:!0},{type:"uint256",name:"poolId",indexed:!0}]},{name:"Harvest",type:"event",inputs:[{type:"uint256",name:"nodeCardId",indexed:!0},{type:"uint256",name:"poolId",indexed:!0},{type:"uint256",name:"reward"}]},{name:"Initialized",type:"event",inputs:[{type:"uint8",name:"version"}]},{name:"config",type:"function",stateMutability:"view",inputs:[],outputs:[{type:"address"}]},{name:"hasRole",type:"function",stateMutability:"view",inputs:[{type:"bytes32",name:"role"},{type:"address",name:"account"}],outputs:[{type:"bool"}]},{name:"node",type:"function",stateMutability:"view",inputs:[],outputs:[{type:"address"}]},{name:"nodeInfoOf",type:"function",stateMutability:"view",inputs:[{type:"uint256"},{type:"uint256"}],outputs:[{type:"uint256",name:"rewardDebt"},{type:"uint256",name:"createdAt"}]},{name:"poolInfoOf",type:"function",stateMutability:"view",inputs:[{type:"uint256"}],outputs:[{type:"uint256",name:"weight"},{type:"uint256",name:"totalCount"},{type:"uint256",name:"accNodePerShare"}]},{name:"totalWeight",type:"function",stateMutability:"view",inputs:[],outputs:[{type:"uint256"}]},{name:"usdt",type:"function",stateMutability:"view",inputs:[],outputs:[{type:"address"}]},{name:"initialize",type:"function",stateMutability:"nonpayable",inputs:[{type:"address",name:"_permissionAdmin"},{type:"address",name:"_usdt"},{type:"address",name:"_node"},{type:"address",name:"_config"}],outputs:[]},{name:"updatePoolWeight",type:"function",stateMutability:"nonpayable",inputs:[{type:"uint256",name:"poolId"},{type:"uint256",name:"weight"}],outputs:[]},{name:"distribute",type:"function",stateMutability:"nonpayable",inputs:[{type:"uint256",name:"amount"}],outputs:[]},{name:"deposit",type:"function",stateMutability:"nonpayable",inputs:[{type:"uint256",name:"nodeCardId"},{type:"uint256",name:"poolId"}],outputs:[]},{name:"earned",type:"function",stateMutability:"view",inputs:[{type:"uint256",name:"nodeCardId"}],outputs:[{type:"uint256"}]},{name:"harvest",type:"function",stateMutability:"nonpayable",inputs:[{type:"uint256",name:"nodeCardId"}],outputs:[]}]},_=()=>{const e=x.c(24),[s,a]=t.useState(),[l,r]=t.useState(0),c=t.useRef(!1),p=t.useRef(!1),{currentNodeCard:o,nodes:m,setSelectedNodeCard:u}=n();let h,f,y,w,g;e[0]!==s?(h=()=>{if(!s)return;const e=()=>{if(!c.current){p.current=!0;const e=s.selectedScrollSnap();r(e)}c.current=!1};return s.on("select",e),()=>{s.off("select",e)}},f=[s],e[0]=s,e[1]=h,e[2]=f):(h=e[1],f=e[2]),t.useEffect(h,f),e[3]!==l||e[4]!==s||e[5]!==m||e[6]!==u?(y=()=>{if(!s||!m||!p.current)return;const e=m[l];e&&(u(e),p.current=!1)},e[3]=l,e[4]=s,e[5]=m,e[6]=u,e[7]=y):y=e[7],e[8]!==l||e[9]!==m?(w=[l,m],e[8]=l,e[9]=m,e[10]=w):w=e[10],t.useEffect(y,w),e[11]!==o||e[12]!==s||e[13]!==m?(g=[m,o,s],e[11]=o,e[12]=s,e[13]=m,e[14]=g):g=e[14],t.useEffect((()=>{var e,t;if(!m||!s||p.current)return;const a=N();null!=a&&-1!==a&&a!==l&&(null==(e=m[a])?void 0:e.cardId)!==(null==(t=m[l])?void 0:t.cardId)&&(c.current=!0,null==s||s.scrollTo(a))}),g);const N=()=>{if(null!=m&&null!=o)return m.findIndex((e=>e.cardId===o.cardId))};let v;e[15]===Symbol.for("react.memo_cache_sentinel")?(v={loop:!1,containScroll:"trimSnaps",align:"center",slidesToScroll:1},e[15]=v):v=e[15];const j=1==(null==m?void 0:m.length)&&"justify-center";let C,b,I;return e[16]!==j?(C=i(j),e[16]=j,e[17]=C):C=e[17],e[18]!==o||e[19]!==m?(b=null!=o&&null!=m&&m.length>0&&m.map(E),e[18]=o,e[19]=m,e[20]=b):b=e[20],e[21]!==C||e[22]!==b?(I=d.jsx(D,{setApi:a,opts:v,className:"mx-auto mb-5 w-full",children:d.jsx(S,{className:C,children:b})}),e[21]=C,e[22]=b,e[23]=I):I=e[23],I};function E(e,t){return d.jsx(I,{className:i(" flex-shrink-0 flex-[0_0_calc(60%_-_10px)]  "),children:d.jsx(N,{className:"w-[180px] h-[247px]",typeId:e.typeId})},t)}const Z=()=>{const{t:a}=e(),{showToast:r}=s(),[p,x]=t.useState(!1),[w,g]=t.useState(!1),[I,D]=t.useState(!1),[S,E]=t.useState(!1),[Z,T]=t.useState(),[O,U]=t.useState(),{currentNodeCard:A,nodes:q,setSelectedNodeCard:P}=n();t.useEffect((()=>{R(),z()}),[A]);const R=async()=>{if(null==A)return;let e=(await B(c)).timestamp;const[t,s,a]=await o(c,{...y,functionName:"nodeTypes",args:[BigInt(A.typeId)]}),[n,d,i]=await o(c,{...y,functionName:"nodeInfos",args:[BigInt(A.cardId)]}),l=Number(d)+93312e3;Number(e)>l&&(e=BigInt(l));const r=0==Number(i)?0:Number(m((Number(e)-Number(i))/2592e3,0));let p;p=r>0?r>36?a*BigInt(36):a*BigInt(r):BigInt(0),T(p)},z=async()=>{if(null==A)return;const[e]=await u(c,{contracts:[{...k,functionName:"earned",args:[BigInt(A.cardId)]}]}).then((e=>e.map((e=>"success"==e.status?e.result:void 0))));null!=e&&U(e)};return d.jsxs("div",{className:"mt-[80px] min-h-screen",children:[d.jsx(M,{isOpen:p,onClose:()=>x(!1),onUpdate:()=>{}}),d.jsx(F,{isOpen:w,onClose:()=>g(!1)}),d.jsx("div",{className:"pt-[20px] md:pt-[88px] container-1200",children:d.jsxs("div",{className:"flex md:flex-row flex-col",children:[h()?d.jsxs("div",{className:"border-[#D8D8D8] md:pr-[52px] md:border-r",children:[d.jsx("div",{className:"flex items-center gap-x-[15px] border-[#D4D4D4] border-[0.63px] bg-[#F6F6F6] px-[15px] md:px-[27px] py-[15px] rounded-[8px] w-full md:w-[505px] md:h-[141px] overflow-auto",children:null!=A&&null!=q&&q.length>0&&q.map(((e,t)=>d.jsxs("div",{onClick:()=>P(e),className:"text-center cursor-pointer",children:[d.jsx(N,{typeId:e.typeId,className:i("w-[56px] h-[77px] contrast-50",A.cardId==e.cardId&&"filter-none w-[63px] h-[87px]")}),d.jsxs("div",{className:i("mt-[5px] text-[#3D3D3D] font-bold text-[12px]",A.cardId==e.cardId&&"text-[#E5331C]"),children:["#",e.cardId]})]},t)))}),d.jsxs("div",{className:"relative mt-[55px] mb-[45px] md:h-[440px] text-center",children:[d.jsx("img",{src:v,className:"m-auto w-[283px] md:w-[466.92px] animate-flicker-soft"}),null!=A&&d.jsx(N,{typeId:A.typeId,className:"top-0 right-0 left-0 absolute w-[220px] md:w-[320px] h-[295px] md:h-[440px]"})]}),d.jsx("div",{className:"gap-y-[8px] grid grid-cols-1 m-auto w-[200px] md:w-[240px] text-[18px]",children:d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsxs("div",{className:"font-bold text-[#E5331C] text-[18px] md:text-[30px]",children:["#",null!=A&&A.cardId]}),d.jsx(l,{onClick:()=>x(!0),variant:"redBorder",className:"w-[90px] md:w-[100px] h-[40px] md:h-[50px] md:!text-[17px]",children:a("transfer")})]})})]}):d.jsxs("div",{children:[d.jsx(_,{}),d.jsxs("div",{className:"gap-y-[8px] grid grid-cols-1 m-auto w-[200px] md:w-[240px] text-[18px]",children:[d.jsx("div",{className:"flex justify-center items-center mb-[14px]",children:d.jsxs("div",{className:"font-bold text-[#E5331C] text-[18px] md:text-[30px]",children:["#",null!=A&&A.cardId]})}),d.jsxs("div",{className:"flex justify-between items-center space-x-[10px]",children:[d.jsx(l,{onClick:()=>x(!0),variant:"redBorder",className:"w-[90px] md:w-[100px] h-[40px] md:h-[50px] md:!text-[17px]",children:a("transfer")}),d.jsx(l,{onClick:()=>g(!0),variant:"redBorder",className:"w-[90px] md:w-[100px] h-[40px]",children:a("node.toggle")})]})]})]}),d.jsxs("div",{className:"mt-[40px] md:pt-[90px] pb-[100px] md:pb-0 md:pl-[71px]",children:[h()&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"font-bold text-[#E5331C] text-[40px]",children:["#",null!=A&&A.cardId]}),d.jsx("div",{className:"font-bold text-[#3D3D3D] text-[48px]",children:"MZU NFT"}),d.jsx(l,{onClick:()=>g(!0),variant:"redBorder",className:"mt-[18px] mb-[70px] w-[115px] h-[60px] !text-[20px]",children:a("node.toggle")})]}),d.jsxs("div",{children:[d.jsxs("div",{className:i("flex items-center justify-between mb-5 border-[#D4D4D4] p-[15px] md:p-[1.2vw] border rounded-[12px] md:w-[580px] md:h-[116px]"),children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("img",{src:"/assets/icon1-BuwACU_D.svg",className:"mr-4 w-[30px] md:w-[52px]"}),d.jsxs("div",{className:"text-left",children:[d.jsxs("div",{className:"text-[12px] text-[rgba(61,61,61,0.7)] md:text-[17px]",children:[a("node.giftToken"),"（MZU）"]}),d.jsx("div",{className:"font-bold text-[#3D3D3D] text-[20px] md:text-[28px]",children:null!=Z&&m(f(Z))})]})]}),d.jsx(l,{disabled:null==Z||0==Number(m(f(Z))),onClick:async()=>{if(null!=A)try{D(!0);const{request:e}=await j(c,{...y,functionName:"claimReward",args:[BigInt(A.cardId)]}),t=await C(c,e);await b(c,{hash:t}),r(a("tips.claimSuccess"),"success"),R()}catch(e){}finally{D(!1)}},loading:I,variant:"red",className:"w-[100px] md:w-[180px] h-[40px] md:h-[60px] md:!text-[20px]",children:a("claim")})]}),d.jsxs("div",{className:i("flex items-center justify-between border-[#D4D4D4] p-[15px] md:p-[1.2vw] border rounded-[12px] md:w-[580px] md:h-[116px]"),children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("img",{src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20fill='none'%20version='1.1'%20width='52'%20height='52.000003814697266'%20viewBox='0%200%2052%2052.000003814697266'%3e%3cdefs%3e%3cclipPath%20id='master_svg0_69_00247'%3e%3crect%20x='0'%20y='0'%20width='52'%20height='52.000003814697266'%20rx='0'/%3e%3c/clipPath%3e%3c/defs%3e%3cg%20clip-path='url(%23master_svg0_69_00247)'%3e%3cg%3e%3cpath%20d='M26.000002,0C11.64091,0,0,11.64091,0,26.000002C0,40.359089,11.64091,52.000004,26.000002,52.000004C40.359089,52.000004,52.000004,40.359089,52.000004,26.000002C52.000004,11.640911,40.359093,0,26.000002,0ZM26.000002,48.868183C13.354546,48.868183,3.1318181,38.645458,3.1318181,26.000002C3.1318181,13.354546,13.354546,3.1318181,26.000002,3.1318181C38.645458,3.1318181,48.868183,13.354546,48.868183,26.000002C48.868183,38.645458,38.645458,48.868183,26.000002,48.868183Z'%20fill='%23FFCC00'%20fill-opacity='1'%20style='mix-blend-mode:passthrough'/%3e%3c/g%3e%3cg%3e%3cpath%20d='M26.0000189375,3.1318359375C13.3545659375,3.1318359375,3.1318359375,13.3545659375,3.1318359375,26.0000189375C3.1318359375,38.6454769375,13.3545629375,48.8682019375,26.0000189375,48.8682019375C38.6454769375,48.8682019375,48.8682019375,38.6454769375,48.8682019375,26.0000189375C48.8682019375,13.3545659375,38.6454769375,3.1318359375,26.0000189375,3.1318359375ZM26.0000189375,47.7454799375C14.0045649375,47.7454799375,4.2545633375000005,37.9954799375,4.2545633375000005,26.0000189375C4.2545633375000005,14.0045649375,14.0045649375,4.2545633375000005,26.0000189375,4.2545633375000005C37.9954799375,4.2545633375000005,47.7454759375,14.0045649375,47.7454759375,26.0000189375C47.7454759375,37.9954799375,37.9954759375,47.7454759375,26.0000189375,47.7454799375Z'%20fill='%23FFF100'%20fill-opacity='1'%20style='mix-blend-mode:passthrough'/%3e%3c/g%3e%3cg%3e%3cpath%20d='M26.000095671875,4.254638671875C14.004638671875,4.254638671875,4.254638671875,14.004638671875,4.254638671875,26.000095671875C4.254638671875,37.995551671875,14.004638671875,47.745548671875,26.000095671875,47.745548671875C37.995551671875,47.745548671875,47.745548671875,37.995544671875,47.745548671875,26.000091671875C47.745551671875,14.004638671875,37.995551671875,4.254638671875,26.000095671875,4.254638671875ZM35.159185671875,29.663732671875C36.754638671875,38.054645671875,33.622821671875,40.241004671875,25.881910671875,36.222820671875C17.963726671875,40.536460671875,14.950090671875,38.409183671875,16.722817671875,29.959182671875C10.281912371875,24.227365671875,11.522820971875,20.741002671875,20.386457671875,19.500094671875C24.286458671875,11.700094271874999,28.068275671875,11.641003171874999,31.791002671875,19.322822671875002C40.595546671875,20.268276671875,41.718276671875,23.695550671875,35.159185671875,29.663732671875Z'%20fill='%23FFD800'%20fill-opacity='1'%20style='mix-blend-mode:passthrough'/%3e%3c/g%3e%3cg%3e%3cpath%20d='M35.15904075,29.66376275C36.754495750000004,38.05467375,33.62267875,40.24103575,25.88176675,36.22285075C17.96358445,40.53648775,14.94994735,38.40921575,16.72267535,29.95921375C10.28176565,24.22739675,11.52267395,20.741034550000002,20.38631055,19.50012495C24.28630975,11.70012455,28.06813075,11.64103365,31.79085575,19.32285265C40.59540175,20.268306250000002,41.71812975,23.695580749999998,35.15904075,29.66376275Z'%20fill='%23FFF600'%20fill-opacity='1'%20style='mix-blend-mode:passthrough'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",className:"mr-4 w-[30px] md:w-[52px]"}),d.jsxs("div",{className:"text-left",children:[d.jsxs("div",{className:"text-[12px] text-[rgba(61,61,61,0.7)] md:text-[17px]",children:[a("node.pendingEarn"),"(USDT)"]}),d.jsx("div",{className:"font-bold text-[#3D3D3D] text-[20px] md:text-[28px]",children:null!=O&&m(f(O))})]})]}),d.jsx(l,{disabled:null==O||0==Number(m(f(O))),onClick:async()=>{if(null!=A)try{E(!0);const{request:e}=await j(c,{...k,functionName:"harvest",args:[BigInt(A.cardId)]}),t=await C(c,e);await b(c,{hash:t}),r(a("tips.claimSuccess"),"success"),z()}catch(e){}finally{E(!1)}},loading:S,variant:"red",className:"w-[100px] md:w-[180px] h-[40px] md:h-[60px] md:!text-[20px]",children:a("claim")})]})]})]})]})})]})};export{Z as default};
