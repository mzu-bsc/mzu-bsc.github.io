System.register(["./index-legacy--kc8mI1-.js"],(function(e,t){"use strict";var n,a,s,r,o,i,c,u,l,d,h,m,f,b,p,g,y,w,P,v,x,B,k,G,I,F,N,T,E,U,z,q,H,L,C,M,R,A,S,$,_,O,j,D,V,K,W,Y,J,Q,Z,X,ee,te;return{setters:[e=>{n=e.I,a=e.J,s=e.K,r=e.M,o=e._,i=e.O,c=e.P,u=e.Q,l=e.S,d=e.T,h=e.E,m=e.U,f=e.W,b=e.Y,p=e.Z,g=e.$,y=e.a0,w=e.a1,P=e.a2,v=e.a3,x=e.a4,B=e.l,k=e.a5,G=e.a6,I=e.a7,F=e.a8,N=e.a9,T=e.aa,E=e.ab,U=e.ac,z=e.ad,q=e.ae,H=e.af,L=e.ag,C=e.ah,M=e.ai,R=e.aj,A=e.ak,S=e.al,$=e.am,_=e.an,O=e.ao,j=e.ap,D=e.aq,V=e.ar,K=e.as,W=e.at,Y=e.au,J=e.av,Q=e.aw,Z=e.ax,X=e.ay,ee=e.H,te=e.az}],execute:function(){async function ne({hash:e,signature:n}){const a=s(e)?e:r(e),{secp256k1:u}=await o((async()=>{const{secp256k1:e}=await t.import("./secp256k1-legacy-BaqSagtm.js");return{secp256k1:e}}),void 0),l=(()=>{if("object"==typeof n&&"r"in n&&"s"in n){const{r:e,s:t,v:a,yParity:s}=n,r=ae(Number(s??a));return new u.Signature(i(e),i(t)).addRecoveryBit(r)}const e=s(n)?n:r(n),t=ae(c(`0x${e.slice(130)}`));return u.Signature.fromCompact(e.substring(2,130)).addRecoveryBit(t)})();return`0x${l.recoverPublicKey(a.substring(2)).toHex(!1)}`}function ae(e){if(0===e||1===e)return e;if(27===e)return 0;if(28===e)return 1;throw new Error("Invalid yParityOrV value")}async function se({hash:e,signature:t}){return function(e){const t=n(`0x${e.substring(4)}`).substring(26);return a(`0x${t}`)}(await ne({hash:e,signature:t}))}function re(e,t="hex"){const n=oe(e),a=u(new Uint8Array(n.length));return n.encode(a),"hex"===t?l(a.bytes):a.bytes}function oe(e){return Array.isArray(e)?function(e){const t=e.reduce(((e,t)=>e+t.length),0),n=ie(t),a=t<=55?1+t:1+n+t;return{length:a,encode(a){t<=55?a.pushByte(192+t):(a.pushByte(247+n),1===n?a.pushUint8(t):2===n?a.pushUint16(t):3===n?a.pushUint24(t):a.pushUint32(t));for(const{encode:t}of e)t(a)}}}(e.map((e=>oe(e)))):function(e){const t="string"==typeof e?d(e):e,n=ie(t.length),a=1===t.length&&t[0]<128?1:t.length<=55?1+t.length:1+n+t.length;return{length:a,encode(e){1===t.length&&t[0]<128?e.pushBytes(t):t.length<=55?(e.pushByte(128+t.length),e.pushBytes(t)):(e.pushByte(183+n),1===n?e.pushUint8(t.length):2===n?e.pushUint16(t.length):3===n?e.pushUint24(t.length):e.pushUint32(t.length),e.pushBytes(t))}}}(e)}function ie(e){if(e<256)return 1;if(e<65536)return 2;if(e<2**24)return 3;if(e<2**32)return 4;throw new h("Length is too large.")}function ce(e){const{chainId:t,nonce:a,to:s}=e,r=e.contractAddress??e.address,o=n(m(["0x05",re([t?f(t):"0x",r,a?f(a):"0x"])]));return"bytes"===s?d(o):o}async function ue(e){const{authorization:t,signature:n}=e;return se({hash:ce(t),signature:n??t})}function le({chain:e,currentChainId:t}){if(!e)throw new b;if(t!==e.id)throw new p({chain:e,currentChainId:t})}function de(e,{docsPath:t,...n}){const a=(()=>{const t=g(e,n);return t instanceof y?e:t})();return new w(a,{docsPath:t,...n})}async function he(e){const t=await e.request({method:"eth_chainId"},{dedupe:!0});return c(t)}e({a:async function(e,t){const{chainId:n,timeout:a=0,...s}=t,r=e.getClient({chainId:n}),o=ee(r,ht,"waitForTransactionReceipt"),i=await o({...s,timeout:a});if("reverted"===i.status){const e=ee(r,at,"getTransaction"),t=await e({hash:i.transactionHash}),n=ee(r,J,"call"),a=await n({...t,data:t.input,gasPrice:"eip1559"!==t.type?t.gasPrice:void 0,maxFeePerGas:"eip1559"===t.type?t.maxFeePerGas:void 0,maxPriorityFeePerGas:"eip1559"===t.type?t.maxPriorityFeePerGas:void 0}),s=a?.data?te(`0x${a.data.substring(138)}`):"unknown reason";throw new Error(s)}return{...i,chainId:r.chain.id}},g:Pe,s:async function(e,t){const{abi:n,chainId:a,connector:s,...r}=t;let o;o=t.account?t.account:(await X(e,{chainId:a,connector:s})).account;const i=e.getClient({chainId:a}),c=ee(i,mt,"simulateContract"),{result:u,request:l}=await c({...r,abi:n,account:o});return{chainId:i.chain.id,result:u,request:{...l,chainId:a}}},w:async function(e,t){const{account:n,chainId:a,connector:s,...r}=t;let o;o="object"==typeof n&&"local"===n?.type?e.getClient({chainId:a}):await X(e,{account:n??void 0,chainId:a,connector:s});const i=ee(o,ft,"writeContract"),c=await i({...r,...n?{account:n}:{},chain:a?{id:a}:null});return c}});class me extends h{constructor(){super("`baseFeeMultiplier` must be greater than 1.",{name:"BaseFeeScalarError"})}}class fe extends h{constructor(){super("Chain does not support EIP-1559 fees.",{name:"Eip1559FeesNotSupportedError"})}}class be extends h{constructor({maxPriorityFeePerGas:e}){super(`\`maxFeePerGas\` cannot be less than the \`maxPriorityFeePerGas\` (${P(e)} gwei).`,{name:"MaxFeePerGasTooLowError"})}}class pe extends h{constructor({blockHash:e,blockNumber:t}){let n="Block";e&&(n=`Block at hash "${e}"`),t&&(n=`Block at number "${t}"`),super(`${n} could not be found.`,{name:"BlockNotFoundError"})}}const ge={"0x0":"legacy","0x1":"eip2930","0x2":"eip1559","0x3":"eip4844","0x4":"eip7702"};function ye(e){const t={...e,blockHash:e.blockHash?e.blockHash:null,blockNumber:e.blockNumber?BigInt(e.blockNumber):null,chainId:e.chainId?c(e.chainId):void 0,gas:e.gas?BigInt(e.gas):void 0,gasPrice:e.gasPrice?BigInt(e.gasPrice):void 0,maxFeePerBlobGas:e.maxFeePerBlobGas?BigInt(e.maxFeePerBlobGas):void 0,maxFeePerGas:e.maxFeePerGas?BigInt(e.maxFeePerGas):void 0,maxPriorityFeePerGas:e.maxPriorityFeePerGas?BigInt(e.maxPriorityFeePerGas):void 0,nonce:e.nonce?c(e.nonce):void 0,to:e.to?e.to:null,transactionIndex:e.transactionIndex?Number(e.transactionIndex):null,type:e.type?ge[e.type]:void 0,typeHex:e.type?e.type:void 0,value:e.value?BigInt(e.value):void 0,v:e.v?BigInt(e.v):void 0};return e.authorizationList&&(t.authorizationList=function(e){return e.map((e=>({address:e.address,chainId:Number(e.chainId),nonce:Number(e.nonce),r:e.r,s:e.s,yParity:Number(e.yParity)})))}(e.authorizationList)),t.yParity=(()=>{if(e.yParity)return Number(e.yParity);if("bigint"==typeof t.v){if(0n===t.v||27n===t.v)return 0;if(1n===t.v||28n===t.v)return 1;if(t.v>=35n)return t.v%2n===0n?1:0}})(),"legacy"===t.type&&(delete t.accessList,delete t.maxFeePerBlobGas,delete t.maxFeePerGas,delete t.maxPriorityFeePerGas,delete t.yParity),"eip2930"===t.type&&(delete t.maxFeePerBlobGas,delete t.maxFeePerGas,delete t.maxPriorityFeePerGas),"eip1559"===t.type&&delete t.maxFeePerBlobGas,t}function we(e){const t=(e.transactions??[]).map((e=>"string"==typeof e?e:ye(e)));return{...e,baseFeePerGas:e.baseFeePerGas?BigInt(e.baseFeePerGas):null,blobGasUsed:e.blobGasUsed?BigInt(e.blobGasUsed):void 0,difficulty:e.difficulty?BigInt(e.difficulty):void 0,excessBlobGas:e.excessBlobGas?BigInt(e.excessBlobGas):void 0,gasLimit:e.gasLimit?BigInt(e.gasLimit):void 0,gasUsed:e.gasUsed?BigInt(e.gasUsed):void 0,hash:e.hash?e.hash:null,logsBloom:e.logsBloom?e.logsBloom:null,nonce:e.nonce?e.nonce:null,number:e.number?BigInt(e.number):null,size:e.size?BigInt(e.size):void 0,timestamp:e.timestamp?BigInt(e.timestamp):void 0,transactions:t,totalDifficulty:e.totalDifficulty?BigInt(e.totalDifficulty):null}}async function Pe(e,{blockHash:t,blockNumber:n,blockTag:a,includeTransactions:s}={}){const r=a??"latest",o=s??!1,i=void 0!==n?f(n):void 0;let c=null;if(c=t?await e.request({method:"eth_getBlockByHash",params:[t,o]},{dedupe:!0}):await e.request({method:"eth_getBlockByNumber",params:[i||r,o]},{dedupe:Boolean(i)}),!c)throw new pe({blockHash:t,blockNumber:n});return(e.chain?.formatters?.block?.format||we)(c)}async function ve(e){const t=await e.request({method:"eth_gasPrice"});return BigInt(t)}async function xe(e,t){const{block:n,chain:a=e.chain,request:s}=t||{};try{const t=a?.fees?.maxPriorityFeePerGas??a?.fees?.defaultPriorityFee;if("function"==typeof t){const a=n||await v(e,Pe,"getBlock")({}),r=await t({block:a,client:e,request:s});if(null===r)throw new Error;return r}if(void 0!==t)return t;const r=await e.request({method:"eth_maxPriorityFeePerGas"});return i(r)}catch{const[t,a]=await Promise.all([n?Promise.resolve(n):v(e,Pe,"getBlock")({}),v(e,ve,"getGasPrice")({})]);if("bigint"!=typeof t.baseFeePerGas)throw new fe;const s=a-t.baseFeePerGas;return s<0n?0n:s}}async function Be(e,t){const{block:n,chain:a=e.chain,request:s,type:r="eip1559"}=t||{},o=await(async()=>"function"==typeof a?.fees?.baseFeeMultiplier?a.fees.baseFeeMultiplier({block:n,client:e,request:s}):a?.fees?.baseFeeMultiplier??1.2)();if(o<1)throw new me;const i=10**(o.toString().split(".")[1]?.length??0),c=e=>e*BigInt(Math.ceil(o*i))/BigInt(i),u=n||await v(e,Pe,"getBlock")({});if("function"==typeof a?.fees?.estimateFeesPerGas){const t=await a.fees.estimateFeesPerGas({block:n,client:e,multiply:c,request:s,type:r});if(null!==t)return t}if("eip1559"===r){if("bigint"!=typeof u.baseFeePerGas)throw new fe;const t="bigint"==typeof s?.maxPriorityFeePerGas?s.maxPriorityFeePerGas:await xe(e,{block:u,chain:a,request:s}),n=c(u.baseFeePerGas);return{maxFeePerGas:s?.maxFeePerGas??n+t,maxPriorityFeePerGas:t}}return{gasPrice:s?.gasPrice??c(await v(e,ve,"getGasPrice")({}))}}class ke extends h{constructor(e,{account:t,docsPath:n,chain:a,data:s,gas:r,gasPrice:o,maxFeePerGas:i,maxPriorityFeePerGas:c,nonce:u,to:l,value:d}){const h=x({from:t?.address,to:l,value:void 0!==d&&`${B(d)} ${a?.nativeCurrency?.symbol||"ETH"}`,data:s,gas:r,gasPrice:void 0!==o&&`${P(o)} gwei`,maxFeePerGas:void 0!==i&&`${P(i)} gwei`,maxPriorityFeePerGas:void 0!==c&&`${P(c)} gwei`,nonce:u});super(e.shortMessage,{cause:e,docsPath:n,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],"Estimate Gas Arguments:",h].filter(Boolean),name:"EstimateGasExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=e}}async function Ge(e,t){const{account:n=e.account}=t,a=n?k(n):void 0;try{const{accessList:s,authorizationList:r,blobs:o,blobVersionedHashes:i,blockNumber:c,blockTag:u,data:l,gas:d,gasPrice:m,maxFeePerBlobGas:b,maxFeePerGas:p,maxPriorityFeePerGas:w,nonce:P,value:v,stateOverride:x,...B}=await We(e,{...t,parameters:"local"===a?.type?void 0:["blobVersionedHashes"]}),T=(c?f(c):void 0)||u,E=G(x),U=await(async()=>B.to?B.to:r&&r.length>0?await ue({authorization:r[0]}).catch((()=>{throw new h("`to` is required. Could not infer from `authorizationList`")})):void 0)();I(t);const z=e.chain?.formatters?.transactionRequest?.format,q=(z||F)({...N(B,{format:z}),from:a?.address,accessList:s,authorizationList:r,blobs:o,blobVersionedHashes:i,data:l,gas:d,gasPrice:m,maxFeePerBlobGas:b,maxFeePerGas:p,maxPriorityFeePerGas:w,nonce:P,to:U,value:v});function H(t){const{block:n,request:a,rpcStateOverride:s}=t;return e.request({method:"eth_estimateGas",params:s?[a,n??"latest",s]:n?[a,n]:[a]})}let L=BigInt(await H({block:T,request:q,rpcStateOverride:E}));if(r){const C=await async function(e,{address:t,blockNumber:n,blockTag:a="latest"}){const s=n?f(n):void 0,r=await e.request({method:"eth_getBalance",params:[t,s||a]});return BigInt(r)}(e,{address:q.from}),M=await Promise.all(r.map((async e=>{const{address:t}=e,n=await H({block:T,request:{authorizationList:void 0,data:l,from:a?.address,to:t,value:f(C)},rpcStateOverride:E}).catch((()=>100000n));return 2n*BigInt(n)})));L+=M.reduce(((e,t)=>e+t),0n)}return L}catch(n){throw function(e,{docsPath:t,...n}){const a=(()=>{const t=g(e,n);return t instanceof y?e:t})();return new ke(a,{docsPath:t,...n})}(n,{...t,account:a,chain:e.chain})}}async function Ie(e,{address:t,blockTag:n="latest",blockNumber:a}){const s=await e.request({method:"eth_getTransactionCount",params:[t,a?f(a):n]},{dedupe:Boolean(a)});return c(s)}function Fe(e){const{kzg:t}=e,n=e.to??("string"==typeof e.blobs[0]?"hex":"bytes"),a="string"==typeof e.blobs[0]?e.blobs.map((e=>d(e))):e.blobs,s=[];for(const r of a)s.push(Uint8Array.from(t.blobToKzgCommitment(r)));return"bytes"===n?s:s.map((e=>l(e)))}function Ne(e){const{kzg:t}=e,n=e.to??("string"==typeof e.blobs[0]?"hex":"bytes"),a="string"==typeof e.blobs[0]?e.blobs.map((e=>d(e))):e.blobs,s="string"==typeof e.commitments[0]?e.commitments.map((e=>d(e))):e.commitments,r=[];for(let o=0;o<a.length;o++){const e=a[o],n=s[o];r.push(Uint8Array.from(t.computeBlobKzgProof(e,n)))}return"bytes"===n?r:r.map((e=>l(e)))}function Te(e,t,n){return e&t^~e&n}function Ee(e,t,n){return e&t^e&n^t&n}class Ue extends T{constructor(e,t,n,a){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=a,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=E(this.buffer)}update(e){U(this);const{view:t,buffer:n,blockLen:a}=this,s=(e=z(e)).length;for(let r=0;r<s;){const o=Math.min(a-this.pos,s-r);if(o!==a)n.set(e.subarray(r,r+o),this.pos),this.pos+=o,r+=o,this.pos===a&&(this.process(t,0),this.pos=0);else{const t=E(e);for(;a<=s-r;r+=a)this.process(t,r)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){U(this),q(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:a,isLE:s}=this;let{pos:r}=this;t[r++]=128,this.buffer.subarray(r).fill(0),this.padOffset>a-r&&(this.process(n,0),r=0);for(let l=r;l<a;l++)t[l]=0;!function(e,t,n,a){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,a);const s=BigInt(32),r=BigInt(4294967295),o=Number(n>>s&r),i=Number(n&r),c=a?4:0,u=a?0:4;e.setUint32(t+c,o,a),e.setUint32(t+u,i,a)}(n,a-8,BigInt(8*this.length),s),this.process(n,0);const o=E(e),i=this.outputLen;if(i%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=i/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<c;l++)o.setUint32(4*l,u[l],s)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:a,finished:s,destroyed:r,pos:o}=this;return e.length=a,e.pos=o,e.finished=s,e.destroyed=r,a%t&&e.buffer.set(n),e}}const ze=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),qe=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),He=new Uint32Array(64);class Le extends Ue{constructor(){super(64,32,8,!1),this.A=0|qe[0],this.B=0|qe[1],this.C=0|qe[2],this.D=0|qe[3],this.E=0|qe[4],this.F=0|qe[5],this.G=0|qe[6],this.H=0|qe[7]}get(){const{A:e,B:t,C:n,D:a,E:s,F:r,G:o,H:i}=this;return[e,t,n,a,s,r,o,i]}set(e,t,n,a,s,r,o,i){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|a,this.E=0|s,this.F=0|r,this.G=0|o,this.H=0|i}process(e,t){for(let l=0;l<16;l++,t+=4)He[l]=e.getUint32(t,!1);for(let l=16;l<64;l++){const e=He[l-15],t=He[l-2],n=L(e,7)^L(e,18)^e>>>3,a=L(t,17)^L(t,19)^t>>>10;He[l]=a+He[l-7]+n+He[l-16]|0}let{A:n,B:a,C:s,D:r,E:o,F:i,G:c,H:u}=this;for(let l=0;l<64;l++){const e=u+(L(o,6)^L(o,11)^L(o,25))+Te(o,i,c)+ze[l]+He[l]|0,t=(L(n,2)^L(n,13)^L(n,22))+Ee(n,a,s)|0;u=c,c=i,i=o,o=r+e|0,r=s,s=a,a=n,n=e+t|0}n=n+this.A|0,a=a+this.B|0,s=s+this.C|0,r=r+this.D|0,o=o+this.E|0,i=i+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(n,a,s,r,o,i,c,u)}roundClean(){He.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Ce=e("b",H((()=>new Le)));function Me(e,t){return Ce(s(e,{strict:!1})?C(e):e)}function Re(e){const{commitment:t,version:n=1}=e,a=e.to??("string"==typeof t?"hex":"bytes"),s=Me(t);return s.set([n],0),"bytes"===a?s:l(s)}const Ae=32,Se=4096,$e=Ae*Se,_e=6*$e-1-1*Se*6;class Oe extends h{constructor({maxSize:e,size:t}){super("Blob size is too large.",{metaMessages:[`Max: ${e} bytes`,`Given: ${t} bytes`],name:"BlobSizeTooLargeError"})}}class je extends h{constructor(){super("Blob data must not be empty.",{name:"EmptyBlobError"})}}function De(e){const{data:t,kzg:n,to:a}=e,s=e.blobs??function(e){const t="string"==typeof e.data?d(e.data):e.data,n=M(t);if(!n)throw new je;if(n>_e)throw new Oe({maxSize:_e,size:n});const a=[];let s=!0,r=0;for(;s;){const e=u(new Uint8Array($e));let n=0;for(;n<Se;){const a=t.slice(r,r+(Ae-1));if(e.pushByte(0),e.pushBytes(a),a.length<31){e.pushByte(128),s=!1;break}n++,r+=31}a.push(e)}return a.map((e=>l(e.bytes)))}({data:t}),r=e.commitments??Fe({blobs:s,kzg:n,to:a}),o=e.proofs??Ne({blobs:s,commitments:r,kzg:n,to:a}),i=[];for(let c=0;c<s.length;c++)i.push({blob:s[c],commitment:r[c],proof:o[c]});return i}const Ve=["blobVersionedHashes","chainId","fees","gas","nonce","type"],Ke=new Map;async function We(e,t){const{account:n=e.account,blobs:a,chain:s,gas:r,kzg:o,nonce:i,nonceManager:c,parameters:u=Ve,type:l}=t,d=n?k(n):n,h={...t,...d?{from:d?.address}:{}};let m,f;async function b(){return m||(m=await v(e,Pe,"getBlock")({blockTag:"latest"}),m)}async function p(){if(f)return f;if(s)return s.id;if(void 0!==t.chainId)return t.chainId;const n=await v(e,he,"getChainId")({});return f=n,f}if(u.includes("nonce")&&void 0===i&&d)if(c){const t=await p();h.nonce=await c.consume({address:d.address,chainId:t,client:e})}else h.nonce=await v(e,Ie,"getTransactionCount")({address:d.address,blockTag:"pending"});if((u.includes("blobVersionedHashes")||u.includes("sidecars"))&&a&&o){const e=Fe({blobs:a,kzg:o});if(u.includes("blobVersionedHashes")){const t=function(e){const{commitments:t,version:n}=e,a=e.to,s=[];for(const r of t)s.push(Re({commitment:r,to:a,version:n}));return s}({commitments:e,to:"hex"});h.blobVersionedHashes=t}if(u.includes("sidecars")){const t=De({blobs:a,commitments:e,proofs:Ne({blobs:a,commitments:e,kzg:o}),to:"hex"});h.sidecars=t}}if(u.includes("chainId")&&(h.chainId=await p()),(u.includes("fees")||u.includes("type"))&&void 0===l)try{h.type=function(e){if(e.type)return e.type;if(void 0!==e.authorizationList)return"eip7702";if(void 0!==e.blobs||void 0!==e.blobVersionedHashes||void 0!==e.maxFeePerBlobGas||void 0!==e.sidecars)return"eip4844";if(void 0!==e.maxFeePerGas||void 0!==e.maxPriorityFeePerGas)return"eip1559";if(void 0!==e.gasPrice)return void 0!==e.accessList?"eip2930":"legacy";throw new R({transaction:e})}(h)}catch{let t=Ke.get(e.uid);if(void 0===t){const n=await b();t="bigint"==typeof n?.baseFeePerGas,Ke.set(e.uid,t)}h.type=t?"eip1559":"legacy"}if(u.includes("fees"))if("legacy"!==h.type&&"eip2930"!==h.type){if(void 0===h.maxFeePerGas||void 0===h.maxPriorityFeePerGas){const n=await b(),{maxFeePerGas:a,maxPriorityFeePerGas:r}=await Be(e,{block:n,chain:s,request:h});if(void 0===t.maxPriorityFeePerGas&&t.maxFeePerGas&&t.maxFeePerGas<r)throw new be({maxPriorityFeePerGas:r});h.maxPriorityFeePerGas=r,h.maxFeePerGas=a}}else{if(void 0!==t.maxFeePerGas||void 0!==t.maxPriorityFeePerGas)throw new fe;if(void 0===t.gasPrice){const t=await b(),{gasPrice:n}=await Be(e,{block:t,chain:s,request:h,type:"legacy"});h.gasPrice=n}}return u.includes("gas")&&void 0===r&&(h.gas=await v(e,Ge,"estimateGas")({...h,account:d?{address:d.address,type:"json-rpc"}:d})),I(h),delete h.parameters,h}async function Ye(e,{serializedTransaction:t}){return e.request({method:"eth_sendRawTransaction",params:[t]},{retryCount:0})}const Je=new S(128);async function Qe(e,t){const{account:n=e.account,chain:a=e.chain,accessList:s,authorizationList:r,blobs:o,data:i,gas:c,gasPrice:u,maxFeePerBlobGas:l,maxFeePerGas:d,maxPriorityFeePerGas:m,nonce:f,value:b,...p}=t;if(void 0===n)throw new A({docsPath:"/docs/actions/wallet/sendTransaction"});const g=n?k(n):null;try{I(t);const y=await(async()=>t.to?t.to:null!==t.to&&r&&r.length>0?await ue({authorization:r[0]}).catch((()=>{throw new h("`to` is required. Could not infer from `authorizationList`.")})):void 0)();if("json-rpc"===g?.type||null===g){let t;null!==a&&(t=await v(e,he,"getChainId")({}),le({currentChainId:t,chain:a}));const h=e.chain?.formatters?.transactionRequest?.format,w=(h||F)({...N(p,{format:h}),accessList:s,authorizationList:r,blobs:o,chainId:t,data:i,from:g?.address,gas:c,gasPrice:u,maxFeePerBlobGas:l,maxFeePerGas:d,maxPriorityFeePerGas:m,nonce:f,to:y,value:b}),P=Je.get(e.uid),x=P?"wallet_sendTransaction":"eth_sendTransaction";try{return await e.request({method:x,params:[w]},{retryCount:0})}catch(n){if(!1===P)throw n;const t=n;if("InvalidInputRpcError"===t.name||"InvalidParamsRpcError"===t.name||"MethodNotFoundRpcError"===t.name||"MethodNotSupportedRpcError"===t.name)return await e.request({method:"wallet_sendTransaction",params:[w]},{retryCount:0}).then((t=>(Je.set(e.uid,!0),t))).catch((n=>{const a=n;if("MethodNotFoundRpcError"===a.name||"MethodNotSupportedRpcError"===a.name)throw Je.set(e.uid,!1),t;throw a}));throw t}}if("local"===g?.type){const t=await v(e,We,"prepareTransactionRequest")({account:g,accessList:s,authorizationList:r,blobs:o,chain:a,data:i,gas:c,gasPrice:u,maxFeePerBlobGas:l,maxFeePerGas:d,maxPriorityFeePerGas:m,nonce:f,nonceManager:g.nonceManager,parameters:[...Ve,"sidecars"],value:b,...p,to:y}),n=a?.serializers?.transaction,h=await g.signTransaction(t,{serializer:n});return await v(e,Ye,"sendRawTransaction")({serializedTransaction:h})}if("smart"===g?.type)throw new $({metaMessages:["Consider using the `sendUserOperation` Action instead."],docsPath:"/docs/actions/bundler/sendUserOperation",type:"smart"});throw new $({docsPath:"/docs/actions/wallet/sendTransaction",type:g?.type})}catch(e){if(e instanceof $)throw e;throw de(e,{...t,account:g,chain:t.chain||void 0})}}const Ze=new Map,Xe=new Map;async function et(e,{cacheKey:t,cacheTime:n=Number.POSITIVE_INFINITY}){const a=function(e){const t=(e,t)=>({clear:()=>t.delete(e),get:()=>t.get(e),set:n=>t.set(e,n)}),n=t(e,Ze),a=t(e,Xe);return{clear:()=>{n.clear(),a.clear()},promise:n,response:a}}(t),s=a.response.get();if(s&&n>0&&(new Date).getTime()-s.created.getTime()<n)return s.data;let r=a.promise.get();r||(r=e(),a.promise.set(r));try{const e=await r;return a.response.set({created:new Date,data:e}),e}finally{a.promise.clear()}}const tt=e=>`blockNumber.${e}`;async function nt(e,{cacheTime:t=e.cacheTime}={}){const n=await et((()=>e.request({method:"eth_blockNumber"})),{cacheKey:tt(e.uid),cacheTime:t});return BigInt(n)}async function at(e,{blockHash:t,blockNumber:n,blockTag:a,hash:s,index:r}){const o=a||"latest",i=void 0!==n?f(n):void 0;let c=null;if(c=s?await e.request({method:"eth_getTransactionByHash",params:[s]},{dedupe:!0}):t?await e.request({method:"eth_getTransactionByBlockHashAndIndex",params:[t,f(r)]},{dedupe:!0}):await e.request({method:"eth_getTransactionByBlockNumberAndIndex",params:[i||o,f(r)]},{dedupe:Boolean(i)}),!c)throw new _({blockHash:t,blockNumber:n,blockTag:o,hash:s,index:r});return(e.chain?.formatters?.transaction?.format||ye)(c)}const st={"0x0":"reverted","0x1":"success"};function rt(e){const t={...e,blockNumber:e.blockNumber?BigInt(e.blockNumber):null,contractAddress:e.contractAddress?e.contractAddress:null,cumulativeGasUsed:e.cumulativeGasUsed?BigInt(e.cumulativeGasUsed):null,effectiveGasPrice:e.effectiveGasPrice?BigInt(e.effectiveGasPrice):null,gasUsed:e.gasUsed?BigInt(e.gasUsed):null,logs:e.logs?e.logs.map((e=>function(e,{args:t,eventName:n}={}){return{...e,blockHash:e.blockHash?e.blockHash:null,blockNumber:e.blockNumber?BigInt(e.blockNumber):null,logIndex:e.logIndex?Number(e.logIndex):null,transactionHash:e.transactionHash?e.transactionHash:null,transactionIndex:e.transactionIndex?Number(e.transactionIndex):null,...n?{args:t,eventName:n}:{}}}(e))):null,to:e.to?e.to:null,transactionIndex:e.transactionIndex?c(e.transactionIndex):null,status:e.status?st[e.status]:null,type:e.type?ge[e.type]||e.type:null};return e.blobGasPrice&&(t.blobGasPrice=BigInt(e.blobGasPrice)),e.blobGasUsed&&(t.blobGasUsed=BigInt(e.blobGasUsed)),t}async function ot(e,{hash:t}){const n=await e.request({method:"eth_getTransactionReceipt",params:[t]},{dedupe:!0});if(!n)throw new O({hash:t});return(e.chain?.formatters?.transactionReceipt?.format||rt)(n)}const it=new Map,ct=new Map;let ut=0;function lt(e,t,n){const a=++ut,s=()=>it.get(e)||[],r=()=>{const t=s();if(!t.some((e=>e.id===a)))return;const n=ct.get(e);1===t.length&&n&&n(),(()=>{const t=s();it.set(e,t.filter((e=>e.id!==a)))})()},o=s();if(it.set(e,[...o,{id:a,fns:t}]),o&&o.length>0)return r;const i={};for(const u in t)i[u]=(...e)=>{const t=s();if(0!==t.length)for(const n of t)n.fns[u]?.(...e)};const c=n(i);return"function"==typeof c&&ct.set(e,c),r}function dt(e,{emitOnBegin:t=!1,emitMissed:n=!1,onBlockNumber:a,onError:s,poll:r,pollingInterval:o=e.pollingInterval}){let c;return(void 0!==r?!r:"webSocket"===e.transport.type||"fallback"===e.transport.type&&"webSocket"===e.transport.transports[0].config.type)?lt(D(["watchBlockNumber",e.uid,t,n]),{onBlockNumber:a,onError:s},(t=>{let n=!0,a=()=>n=!1;return(async()=>{try{const s=(()=>{if("fallback"===e.transport.type){const t=e.transport.transports.find((e=>"webSocket"===e.config.type));return t?t.value:e.transport}return e.transport})(),{unsubscribe:r}=await s.subscribe({params:["newHeads"],onData(e){if(!n)return;const a=i(e.result?.number);t.onBlockNumber(a,c),c=a},onError(e){t.onError?.(e)}});a=r,n||a()}catch(e){s?.(e)}})(),()=>a()})):lt(D(["watchBlockNumber",e.uid,t,n,o]),{onBlockNumber:a,onError:s},(a=>function(e,{emitOnBegin:t,initialWaitTime:n,interval:a}){let s=!0;const r=()=>s=!1;return(async()=>{let o;t&&(o=await e({unpoll:r}));const i=await(n?.(o))??a;await j(i);const c=async()=>{s&&(await e({unpoll:r}),await j(a),c())};c()})(),r}((async()=>{try{const t=await v(e,nt,"getBlockNumber")({cacheTime:0});if(c){if(t===c)return;if(t-c>1&&n)for(let e=c+1n;e<t;e++)a.onBlockNumber(e,c),c=e}(!c||t>c)&&(a.onBlockNumber(t,c),c=t)}catch(e){a.onError?.(e)}}),{emitOnBegin:t,interval:o})))}async function ht(e,{confirmations:t=1,hash:n,onReplaced:a,pollingInterval:s=e.pollingInterval,retryCount:r=6,retryDelay:o=({count:e})=>200*(1<<e),timeout:i=18e4}){const c=D(["waitForTransactionReceipt",e.uid,n]);let u,l,d,h=!1;const{promise:m,resolve:f,reject:b}=V(),p=i?setTimeout((()=>b(new K({hash:n}))),i):void 0,g=lt(c,{onReplaced:a,resolve:f,reject:b},(a=>{const i=v(e,dt,"watchBlockNumber")({emitMissed:!0,emitOnBegin:!0,poll:!0,pollingInterval:s,async onBlockNumber(s){const c=e=>{clearTimeout(p),i(),e(),g()};let m=s;if(!h)try{if(d){if(t>1&&(!d.blockNumber||m-d.blockNumber+1n<t))return;return void c((()=>a.resolve(d)))}if(u||(h=!0,await W((async()=>{u=await v(e,at,"getTransaction")({hash:n}),u.blockNumber&&(m=u.blockNumber)}),{delay:o,retryCount:r}),h=!1),d=await v(e,ot,"getTransactionReceipt")({hash:n}),t>1&&(!d.blockNumber||m-d.blockNumber+1n<t))return;c((()=>a.resolve(d)))}catch(n){if(n instanceof _||n instanceof O){if(!u)return void(h=!1);try{l=u,h=!0;const n=await W((()=>v(e,Pe,"getBlock")({blockNumber:m,includeTransactions:!0})),{delay:o,retryCount:r,shouldRetry:({error:e})=>e instanceof pe});h=!1;const s=n.transactions.find((({from:e,nonce:t})=>e===l.from&&t===l.nonce));if(!s)return;if(d=await v(e,ot,"getTransactionReceipt")({hash:s.hash}),t>1&&(!d.blockNumber||m-d.blockNumber+1n<t))return;let i="replaced";s.to===l.to&&s.value===l.value&&s.input===l.input?i="repriced":s.from===s.to&&0n===s.value&&(i="cancelled"),c((()=>{a.onReplaced?.({reason:i,replacedTransaction:l,transaction:s,transactionReceipt:d}),a.resolve(d)}))}catch(e){c((()=>a.reject(e)))}}else c((()=>a.reject(n)))}}})}));return m}async function mt(e,t){const{abi:n,address:a,args:s,dataSuffix:r,functionName:o,...i}=t,c=i.account?k(i.account):e.account,u=Y({abi:n,args:s,functionName:o});try{const{data:l}=await v(e,J,"call")({batch:!1,data:`${u}${r?r.replace("0x",""):""}`,to:a,...i,account:c}),d=Q({abi:n,args:s,functionName:o,data:l||"0x"}),h=n.filter((e=>"name"in e&&e.name===t.functionName));return{result:d,request:{abi:h,address:a,args:s,dataSuffix:r,functionName:o,...i,account:c}}}catch(e){throw Z(e,{abi:n,address:a,args:s,docsPath:"/docs/contract/simulateContract",functionName:o,sender:c?.address})}}async function ft(e,t){const{abi:n,account:a=e.account,address:s,args:r,dataSuffix:o,functionName:i,...c}=t;if(void 0===a)throw new A({docsPath:"/docs/contract/writeContract"});const u=a?k(a):null,l=Y({abi:n,args:r,functionName:i});try{return await v(e,Qe,"sendTransaction")({data:`${l}${o?o.replace("0x",""):""}`,to:s,account:u,...c})}catch(e){throw Z(e,{abi:n,address:s,args:r,docsPath:"/docs/contract/writeContract",functionName:i,sender:u?.address})}}}}}));
